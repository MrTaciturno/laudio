<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <title>Reconhecimento de Áudio</title>
</head>
<body>
  <h1>Reconhecimento de Áudio</h1>
  <button id="start-btn">Iniciar Reconhecimento</button>
  <button id="stop-btn" disabled>Parar</button>
  <br><br>
  <label for="caixa-texto">Texto reconhecido:</label><br>
  <textarea id="caixa-texto" rows="5" cols="60" readonly></textarea>
  <p id="resultado" style="display: none;"></p>

  <script>
    const startBtn = document.getElementById('start-btn');
    const stopBtn = document.getElementById('stop-btn');
    const resultado = document.getElementById('resultado');
    const caixaTexto = document.getElementById('caixa-texto');

    // Verifica compatibilidade
    window.SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;

    if ('SpeechRecognition' in window) {
      const recognition = new window.SpeechRecognition();
      recognition.lang = 'pt-BR';
      recognition.interimResults = true; // Mudar para true para resultado em tempo real
      recognition.maxAlternatives = 1;

      let textoFinal = '';

      startBtn.onclick = function() {
        recognition.start();
        startBtn.disabled = true;
        stopBtn.disabled = false;
        caixaTexto.value = '';
        textoFinal = '';
      };

      stopBtn.onclick = function() {
        recognition.stop();
        startBtn.disabled = false;
        stopBtn.disabled = true;
      };

      recognition.onresult = function(event) {
        let interimTranscript = '';
        for (let i = event.resultIndex; i < event.results.length; ++i) {
          let transcript = event.results[i][0].transcript;
          if (event.results[i].isFinal) {
            textoFinal += transcript;
          } else {
            interimTranscript += transcript;
          }
        }
        caixaTexto.value = textoFinal + interimTranscript;
      };

      recognition.onerror = function(event) {
        resultado.style.display = "";
        resultado.textContent = 'Erro: ' + event.error;
        startBtn.disabled = false;
        stopBtn.disabled = true;
      };

      recognition.onend = function() {
        startBtn.disabled = false;
        stopBtn.disabled = true;
      };
    } else {
      resultado.style.display = "";
      resultado.textContent = "Reconhecimento de voz não suportado neste navegador.";
      startBtn.disabled = true;
      stopBtn.disabled = true;
    }
  </script>
</body>
</html>
